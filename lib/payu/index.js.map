{"version":3,"sources":["../../src/payu/index.js"],"names":["recurringPayments","require","PayU","prodAccountData","environment","payUUrlsMap","getPayUUrlsMapByEnvironment","accountData","getTestAccountData","validateConstructurParams","err","env","dev","queries","payments","prod","apiLogin","apiKey","merchantId","accountId","params","cb","validationResult","title","type","properties","required","errors","length","module","exports"],"mappings":";;;;AAAA;;;;AACA,IAAIA,oBAAoBC,QAAQ,qBAAR,CAAxB;;IAEMC,I;AAEF,kBAAaC,eAAb,EAA8B;AAAA;;AAAA;;AAE1B;AACA,aAAKC,WAAL,GAAoB,CAAC,CAACD,eAAF,GAAoB,MAApB,GAA6B,KAAjD;AACA,aAAKE,WAAL,GAAmB,KAAKC,2BAAL,CAAiC,KAAKF,WAAtC,CAAnB;;AAEA;AACA,gBAAQ,KAAKA,WAAb;AACI,iBAAK,KAAL;AACI,qBAAKG,WAAL,GAAmB,KAAKC,kBAAL,EAAnB;AACJ;AACA,iBAAK,MAAL;AACI,qBAAKC,yBAAL,CAA+BN,eAA/B,EAAgD,UAACO,GAAD,EAAS;AACrD,wBAAIA,GAAJ,EAAS;AACL,8BAAMA,GAAN;AACA;AACH;AACD,0BAAKH,WAAL,GAAmBJ,eAAnB;AACH,iBAND;AAOJ;AAZJ;;AAeA;AACA,aAAKH,iBAAL,GAAyBA,kBAAkB,KAAKK,WAAvB,EAAoC,KAAKE,WAAzC,CAAzB;AACH;;;;oDAE4BI,G,EAAK;AAC9B,mBAAQ;AACJC,qBAAK;AACDC,6BAAS,+DADR;AAEDC,8BAAU;AAFT,iBADD;AAKJC,sBAAM;AACFF,6BAAS,uDADP;AAEFC,8BAAU;AAFR;AALF,aAAD,CASJH,GATI,CAAP;AAUH;;;6CAEqB;AAClB,mBAAO;AACHK,0BAAU,iBADP;AAEHC,wBAAQ,4BAFL;AAGHC,4BAAY,QAHT;AAIHC,2BAAW;AAJR,aAAP;AAMH;;;kDAE0BC,M,EAAQC,E,EAAI;AACnC,gBAAIC,mBAAmB,0BACnBF,MADmB,EACX;AACJG,uBAAO,yBADH;AAEJC,sBAAM,QAFF;AAGJC,4BAAY;AACRT,8BAAU,EAAEQ,MAAM,QAAR,EADF;AAERP,4BAAQ,EAAEO,MAAM,QAAR,EAFA;AAGRN,gCAAY,EAAEM,MAAM,QAAR,EAHJ;AAIRL,+BAAW,EAAEK,MAAM,QAAR;AAJH,iBAHR;AASJE,0BAAU,CAAC,UAAD,EAAa,QAAb,EAAuB,YAAvB,EAAqC,WAArC;AATN,aADW,CAAvB;AAaA,gBAAIJ,iBAAiBK,MAAjB,CAAwBC,MAA5B,EAAoC;AAChCP,mBAAGC,iBAAiBK,MAApB;AACA;AACH;AACDN;AACH;;;;;;AAILQ,OAAOC,OAAP,GAAiB5B,IAAjB","file":"index.js","sourcesContent":["import {validate as validateJSONSchema} from 'jsonschema';\nvar recurringPayments = require('./recurringPayments');\n\nclass PayU {\n\n    constructor (prodAccountData) {\n\n        // Initialize instance\n        this.environment = (!!prodAccountData ? 'prod' : 'dev');\n        this.payUUrlsMap = this.getPayUUrlsMapByEnvironment(this.environment);\n        \n        // Setup account data\n        switch (this.environment) {\n            case 'dev':\n                this.accountData = this.getTestAccountData();\n            break;\n            case 'prod':\n                this.validateConstructurParams(prodAccountData, (err) => {\n                    if (err) {\n                        throw err;\n                        return;\n                    }\n                    this.accountData = prodAccountData;\n                })\n            break;\n        }\n\n        // Setup transactions\n        this.recurringPayments = recurringPayments(this.payUUrlsMap, this.accountData);\n    }\n\n    getPayUUrlsMapByEnvironment (env) {\n        return ({\n            dev: {\n                queries: 'https://sandbox.api.payulatam.com/reports-api/4.0/service.cgi',\n                payments: 'https://sandbox.api.payulatam.com/payments-api',\n            },\n            prod: {\n                queries: 'https://api.payulatam.com/reports-api/4.0/service.cgi',\n                payments: 'https://api.payulatam.com/payments-api',\n            },\n        })[env];\n    }\n\n    getTestAccountData () {\n        return {\n            apiLogin: 'pRRXKOl8ikMmt9u',\n            apiKey: '4Vj8eK4rloUd272L48hsrarnUA',\n            merchantId: '508029',\n            accountId: '512323',\n        }\n    }\n\n    validateConstructurParams (params, cb) {\n        var validationResult = validateJSONSchema(\n            params, {\n                title: 'PayU Constructor Schema',\n                type: 'object',\n                properties: {\n                    apiLogin: { type: 'string' },\n                    apiKey: { type: 'string' },\n                    merchantId: { type: 'string' },\n                    accountId: { type: 'string' },\n                },\n                required: ['apiLogin', 'apiKey', 'merchantId', 'accountId']\n            }\n        )\n        if (validationResult.errors.length) {\n            cb(validationResult.errors);\n            return;\n        }\n        cb();\n    }\n\n}\n\nmodule.exports = PayU;"]}