{"version":3,"sources":["../../src/payu/tokenization.js"],"names":["Q","require","base64","module","exports","payUUrlsMap","accountData","transactions","secureHash","encode","apiLogin","apiKey","registerCard","cardData","deferred","defer","queries","headers","data","test","then","resp","Math","floor","statusCode","resolve","body","reject","catch","err","promise"],"mappings":";;AAAA;;AACA,IAAIA,IAAIC,QAAQ,GAAR,CAAR;AACA,IAAIC,SAASD,QAAQ,SAAR,CAAb;;AAEAE,OAAOC,OAAP,GAAiB,UAAUC,WAAV,EAAuBC,WAAvB,EAAoC;AACjD,QAAIC,eAAe,EAAnB;AACA,QAAIC,aAAaN,OAAOO,MAAP,CAAcH,YAAYI,QAAZ,GAAqB,GAArB,GAAyBJ,YAAYK,MAAnD,CAAjB;;AAEA;AACAJ,iBAAaK,YAAb,GAA4B,UAAUC,QAAV,EAAoB;AAC5C,YAAIC,WAAWd,EAAEe,KAAF,EAAf;AACA,sCAAY,MAAZ,EAAoBV,YAAYW,OAAhC,EAAyC;AACrCC,qBAAS;AACL,iCAAiB,WAAST;AADrB,aAD4B;AAIrCU,kBAAM;AACF,wBAAQZ,YAAYa,IADlB;AAEF,4BAAY,IAFV;AAGF,2BAAW,cAHT;AAIF,4BAAY;AACR,gCAAYb,YAAYI,QADhB;AAER,8BAAUJ,YAAYK;AAFd,iBAJV;AAQF,mCAAmBE;AARjB;AAJ+B,SAAzC,EAcGO,IAdH,CAcQ,UAAUC,IAAV,EAAgB;AACpB,gBAAIC,KAAKC,KAAL,CAAWF,KAAKG,UAAL,GAAgB,GAA3B,KAAmC,CAAvC,EAA0C;AACtCV,yBAASW,OAAT,CAAiBJ,KAAKK,IAAtB;AACA;AACH;AACDZ,qBAASa,MAAT,CAAgBN,IAAhB;AACH,SApBD,EAoBGO,KApBH,CAoBS,UAAUC,GAAV,EAAe;AACpBf,qBAASa,MAAT,CAAgBE,GAAhB;AACH,SAtBD;AAuBA,eAAOf,SAASgB,OAAhB;AACH,KA1BD;;AA4BA,WAAOvB,YAAP;AACH,CAlCD","file":"tokenization.js","sourcesContent":["import { httpRequest } from '../services/httpRequest';\nvar Q = require('q');\nvar base64 = require('base-64');\n\nmodule.exports = function (payUUrlsMap, accountData) {\n    var transactions = {};\n    var secureHash = base64.encode(accountData.apiLogin+':'+accountData.apiKey);\n\n    // Register credit card\n    transactions.registerCard = function (cardData) {\n        var deferred = Q.defer();\n        httpRequest('POST', payUUrlsMap.queries, {\n            headers: {\n                'Authorization': 'Basic '+secureHash\n            },\n            data: {\n                \"test\": accountData.test,\n                \"language\": \"en\",\n                \"command\": \"CREATE_TOKEN\",\n                \"merchant\": {\n                    \"apiLogin\": accountData.apiLogin,\n                    \"apiKey\": accountData.apiKey\n                },\n                \"creditCardToken\": cardData\n            }\n        }).then(function (resp) {\n            if (Math.floor(resp.statusCode/100) == 2) {\n                deferred.resolve(resp.body);\n                return;\n            }\n            deferred.reject(resp);\n        }).catch(function (err) {\n            deferred.reject(err);\n        });\n        return deferred.promise;\n    }\n\n    return transactions;\n}"]}